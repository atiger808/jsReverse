(global.webpackJsonp=global.webpackJsonp||[]).push([["components/tui-picture-cropper/tui-picture-cropper"],{"0734":function(t,e,i){"use strict";(function(t){var n=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("7eb4")),o=n(i("7ca3")),s=n(i("ee10"));function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function r(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){(0,o.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var h={name:"tuiPictureCropper",props:{imageUrl:{type:String,default:""},height:{type:Number,default:280},width:{type:Number,default:280},minWidth:{type:Number,default:100},minHeight:{type:Number,default:100},maxWidth:{type:Number,default:360},maxHeight:{type:Number,default:360},borderColor:{type:String,default:"rgba(255,255,255,0.1)"},edgeColor:{type:String,default:"#FFFFFF"},edgeWidth:{type:String,default:"34rpx"},edgeBorderWidth:{type:String,default:"6rpx"},edgeOffsets:{type:String,default:"6rpx"},lockWidth:{type:Boolean,default:!1},lockHeight:{type:Boolean,default:!1},lockRatio:{type:Boolean,default:!1},scaleRatio:{type:Number,default:2},quality:{type:Number,default:.8},rotateAngle:{type:Number,default:0},minScale:{type:Number,default:.5},maxScale:{type:Number,default:2},disableRotate:{type:Boolean,default:!0},limitMove:{type:Boolean,default:!0},custom:{type:Boolean,default:!1},startCutting:{type:[Number,Boolean],default:0},isBase64:{type:Boolean,default:!1},loadding:{type:Boolean,default:!0},rotateImg:{type:String,default:"/static/components/cropper/img_rotate.png"}},data:function(){return{TIME_CUT_CENTER:null,CROPPER_WIDTH:200,CROPPER_HEIGHT:200,cutX:0,cutY:0,canvasWidth:0,canvasHeight:0,imgWidth:0,imgHeight:0,scale:1,angle:0,cutAnimation:!1,cutAnimationTime:null,imgTop:0,imgLeft:0,ctx:null,sysInfo:{},props:"",sizeChange:0,angleChange:0,resetChange:0,centerChange:0}},watch:{imageUrl:function(e,i){var n=this;this.imageReset(),this.showLoading(),t.getImageInfo({src:e,success:function(t){n.imgComputeSize(t.width,t.height),n.limitMove&&(n.angleChange++,n.props="3,".concat(n.angleChange))},fail:function(t){n.imgComputeSize(),n.limitMove&&(n.angleChange++,n.props="3,".concat(n.angleChange))}})},rotateAngle:function(t){this.cutAnimation=!0,this.angle=t,this.angleChanged(t)},cutAnimation:function(t){var e=this;clearTimeout(this.cutAnimationTime),t&&(this.cutAnimationTime=setTimeout((function(){e.cutAnimation=!1}),260))},limitMove:function(t){t&&this.angleChanged(this.angle)},startCutting:function(t){this.custom&&t&&this.getImage()}},mounted:function(){var e=this;this.sysInfo=t.getSystemInfoSync(),this.imgTop=this.sysInfo.windowHeight/2,this.imgLeft=this.sysInfo.windowWidth/2,this.CROPPER_WIDTH=this.width,this.CROPPER_HEIGHT=this.height,this.canvasHeight=this.height,this.canvasWidth=this.width,this.ctx=t.createCanvasContext("tui-image-cropper",this),setTimeout((function(){e.props="1,1"}),0),setTimeout((function(){e.$emit("ready",{})}),200)},methods:{getLocalImage:function(e){return(0,s.default)(a.default.mark((function i(){return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,new Promise((function(i,n){t.downloadFile({url:e,success:function(t){i(t.tempFilePath)},fail:function(t){n(!1)}})}));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}}),i)})))()},getImage:function(){var e=this;if(this.imageUrl){this.loadding&&this.showLoading();var i=function(){var i=(0,s.default)(a.default.mark((function i(){var n,o,s,c,h;return a.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n=e.imgWidth*e.scale*e.scaleRatio,o=e.imgHeight*e.scale*e.scaleRatio,s=e.imgLeft-e.cutX,c=e.imgTop-e.cutY,e.ctx.translate(s*e.scaleRatio,c*e.scaleRatio),e.ctx.rotate(e.angle*Math.PI/180),h=e.imageUrl,!~e.imageUrl.indexOf("https:")){i.next=11;break}return i.next=10,e.getLocalImage(e.imageUrl);case 10:h=i.sent;case 11:e.ctx.drawImage(h,-n/2,-o/2,n,o),e.ctx.draw(!1,(function(){var i={width:e.canvasWidth*e.scaleRatio,height:Math.round(e.canvasHeight*e.scaleRatio),destWidth:e.canvasWidth*e.scaleRatio,destHeight:Math.round(e.canvasHeight)*e.scaleRatio,fileType:"png",quality:e.quality},n={url:"",base64:"",width:e.canvasWidth*e.scaleRatio,height:e.canvasHeight*e.scaleRatio};e.isBase64?t.canvasGetImageData({canvasId:"tui-image-cropper",x:0,y:0,width:e.canvasWidth*e.scaleRatio,height:Math.round(e.canvasHeight*e.scaleRatio),success:function(i){var a=new Uint8Array(i.data),o=t.arrayBufferToBase64(a);n.base64=o,e.loadding&&t.hideLoading(),e.$emit("cropper",n)}},e):t.canvasToTempFilePath(r(r({},i),{},{canvasId:"tui-image-cropper",success:function(i){n.url=i.tempFilePath,e.loadding&&t.hideLoading(),e.$emit("cropper",n)},fail:function(t){console.log(t)}}),e)}));case 13:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}();this.CROPPER_WIDTH!=this.canvasWidth||this.CROPPER_HEIGHT!=this.canvasHeight?(this.CROPPER_WIDTH=this.canvasWidth,this.CROPPER_HEIGHT=this.canvasHeight,this.$nextTick((function(){e.ctx.draw(),setTimeout((function(){i()}),100)}))):i()}else t.showToast({title:"请选择图片",icon:"none"})},change:function(t){this.cutX=t.cutX||0,this.cutY=t.cutY||0,this.canvasWidth=t.canvasWidth||this.width,this.canvasHeight=t.canvasHeight||this.height,this.imgWidth=t.imgWidth||this.imgWidth,this.imgHeight=t.imgHeight||this.imgHeight,this.scale=t.scale||1,this.angle=t.angle||0,this.imgTop=t.imgTop||0,this.imgLeft=t.imgLeft||0},imageReset:function(){this.scale=1,this.angle=0;var e=this.sysInfo.windowHeight?this.sysInfo:t.getSystemInfoSync();this.imgTop=e.windowHeight/2,this.imgLeft=e.windowWidth/2,this.resetChange++,this.props="4,".concat(this.resetChange),this.$emit("initAngle",{})},imageLoad:function(e){this.imageReset(),t.hideLoading(),this.$emit("imageLoad",{})},imgComputeSize:function(e,i){var n=e,a=i;n&&a?n/a>this.width/this.height?n=e/i*(a=this.height):a=i/e*(n=this.width):(n=(this.sysInfo||t.getSystemInfoSync()).windowWidth,a=0),this.imgWidth=n,this.imgHeight=a,this.sizeChange++,this.props="2,".concat(this.sizeChange)},moveStop:function(){var t=this;clearTimeout(this.TIME_CUT_CENTER),this.TIME_CUT_CENTER=setTimeout((function(){t.cutAnimation||(t.cutAnimation=!0),t.centerChange++,t.props="5,".concat(t.centerChange)}),666)},moveDuring:function(){clearTimeout(this.TIME_CUT_CENTER)},showLoading:function(){t.showLoading({title:"请稍候...",mask:!0})},stop:function(){},back:function(){t.navigateBack()},angleChanged:function(t){this.moveStop(),this.limitMove&&t%90&&(this.angle=90*Math.round(t/90)),this.angleChange++,this.props="3,".concat(this.angleChange)},setAngle:function(){this.cutAnimation=!0,this.angle=this.angle+90,this.angleChanged(this.angle)}}};e.default=h}).call(this,i("df3c").default)},28759:function(t,e,i){"use strict";var n=i("7b90");i.n(n).a},"7b90":function(t,e,i){},"7cc1":function(t,e,i){"use strict";e.a=function(t){t.options.wxsCallMethods||(t.options.wxsCallMethods=[]),t.options.wxsCallMethods.push("moveDuring"),t.options.wxsCallMethods.push("moveStop"),t.options.wxsCallMethods.push("change")}},e22a:function(t,e,i){"use strict";i.r(e);var n=i("f542"),a=i("ec4b");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("28759");var s=i("828b"),c=i("7cc1"),r=Object(s.a)(a.default,n.b,n.c,!1,null,"d68cfe7c",null,!1,n.a,void 0);"function"==typeof c.a&&Object(c.a)(r),e.default=r.exports},ec4b:function(t,e,i){"use strict";i.r(e);var n=i("0734"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e.default=a.a},f542:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){this.$createElement,this._self._c},a=[]}}]),(global.webpackJsonp=global.webpackJsonp||[]).push(["components/tui-picture-cropper/tui-picture-cropper-create-component",{"components/tui-picture-cropper/tui-picture-cropper-create-component":function(t,e,i){i("df3c").createComponent(i("e22a"))}},[["components/tui-picture-cropper/tui-picture-cropper-create-component"]]]);