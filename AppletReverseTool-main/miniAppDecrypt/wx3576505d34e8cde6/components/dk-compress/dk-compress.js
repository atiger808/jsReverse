(global.webpackJsonp=global.webpackJsonp||[]).push([["components/dk-compress/dk-compress"],{"06d7":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){this.$createElement,this._self._c},a=[]},4748:function(e,t,n){},"988f":function(e,t,n){"use strict";(function(e){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("7eb4")),c=r(n("ee10")),u=e.getFileSystemManager(),i=(e.getSystemInfoSync().pixelRatio,{data:function(){return{pic:"",canvasSize:{width:0,height:0}}},methods:{compress:function(t){var n=this;return new Promise(function(){var r=(0,c.default)(a.default.mark((function r(u,i){var s,o,f,p,l;return a.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getImageInfo(t.src);case 2:if(s=r.sent){r.next=6;break}return i("获取图片信息异常"),r.abrupt("return");case 6:return r.next=8,n.getSize(t.src);case 8:if(!((o=r.sent)<=204800)){r.next=11;break}return r.abrupt("return",u(t.src));case 11:t.maxSize,t.minSize,f=s.width,p=s.height,n.$set(n,"canvasSize",{width:"".concat(f,"rpx"),height:"".concat(p,"rpx")}),l=n.getQuality(o),setTimeout((function(){var r=e.createCanvasContext("myCanvas",n);r.clearRect(0,0,f,p),r.drawImage(s.path,0,0,e.upx2px(f),e.upx2px(p)),r.draw(!1,(function(){e.canvasToTempFilePath({width:e.upx2px(f),height:e.upx2px(p),canvasId:"myCanvas",fileType:t.fileType||"jpg",quality:l||.8,success:function(){var e=(0,c.default)(a.default.mark((function e(r){var c;return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getSize(r.tempFilePath);case 2:c=e.sent,console.log("sizeeeeeeeee",c,o),u(c>o?t.src:r.tempFilePath);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fail:function(e){i(null)}},n)}))}),700);case 17:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())},getQuality:function(e){var t=1;return e>102400?t=1:e>204800&&e<1048576?t=.8:e>1048576&&e<3145728?t=.7:e>3145728&&e<5242880?t=.6:e>5242880&&(t=.3),t},getSize:function(e){return new Promise((function(t,n){u.getFileInfo({filePath:e,success:function(e){var n=e.size;t(n)},fail:function(e){n(e)}})}))},getImageInfo:function(t){return new Promise((function(n,r){e.getImageInfo({src:t,success:function(e){n(e)},fail:function(){r(null)}})}))},batchCompress:function(e){var t=this,n=0,r=0,u=0,i=[],s=function(){return new Promise((function(t,s){var f=function(){var s=(0,c.default)(a.default.mark((function c(){var s;return a.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.progress&&e.progress({done:r,fail:u,count:e.batchSrc.length}),a.next=3,o();case 3:(s=a.sent)?(r++,i.push(s)):u++,++n>=e.batchSrc.length?t(!0):f();case 7:case"end":return a.stop()}}),c)})));return function(){return s.apply(this,arguments)}}();f()}))},o=function(){return t.compress({src:e.batchSrc[n],maxSize:e.maxSize,fileType:e.fileType,quality:e.quality,minSize:e.minSize})};return new Promise(function(){var e=(0,c.default)(a.default.mark((function e(t,n){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s();case 2:e.sent?t(i):n(null);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}});t.default=i}).call(this,n("df3c").default)},b644:function(e,t,n){"use strict";var r=n("4748");n.n(r).a},d4d9:function(e,t,n){"use strict";n.r(t);var r=n("06d7"),a=n("fea3");for(var c in a)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(c);n("b644");var u=n("828b"),i=Object(u.a)(a.default,r.b,r.c,!1,null,"52e4c1bd",null,!1,r.a,void 0);t.default=i.exports},fea3:function(e,t,n){"use strict";n.r(t);var r=n("988f"),a=n.n(r);for(var c in r)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(c);t.default=a.a}}]),(global.webpackJsonp=global.webpackJsonp||[]).push(["components/dk-compress/dk-compress-create-component",{"components/dk-compress/dk-compress-create-component":function(e,t,n){n("df3c").createComponent(n("d4d9"))}},[["components/dk-compress/dk-compress-create-component"]]]);